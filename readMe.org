* mobius transformations
** idea
   algebra and geometry of
   the extended complex numbers and
   linear fractional transformations

   geometric objects:
   points lines circles triangles
   and their images under application of linear fractional transformations

   two complex planes
   pre-image and image

   stereographic projection
   the extended complex plane
   and the Reiman sphere
   in perspective

** app behavior
   app is either in mouse mode or animation mode
   in animation mode, mouse mode is disabled

   display elements are rendered one at a time
   on top of each other

   animate button will render everything in render list,
   in order added, one element at a time
   using an offscreen buffer to redraw
   everything in render list quickly

   in mouse mode, render list is displayed first
   then mouse position, kept in local state, is displayed

   mouse mode used to create objects to be added to render list

   elements in render list consist of
   predifined elements including
   axis, unit circle,
   rectangular grid lines
   concentric circles about origin
   radial lines through origin

   custom elements defined through mouse mode
   and then added to render list

   render list should be viewable and editable

   switching transforms shoud triger either
   an animated redraw or an instant redraw

   once a render list is created,
   one could save as an svg or
   save as data and send to server,
   or save on local file system

** implementation
*** vector
    in vector.cljs
    algebraic operations for vectors and matrices

    sum product
    scal-mul
    dot
    len len-sq
    angle
    midpoint
    mvmult
    mmmult
    mat-inverse

*** complex number
    in complex.cljs

    represented as
    a vector of two rational numbers
    [x y] or [r a]
    with the possibility of being infinity
    where 1/zero = infinity and 1/infinity = zero
    and zero/zero = infinity/infinity = undefined

    complex numbers can be added, multiplied and conjugated
    they have a length and an angle

*** linear fractional transformation
    in trasnforms.cljs

    represented as
    a vector of four complex numbers
    [a b c d]
    that can be normalized so that
    ad - bc = 1
    has a determinant, trace, inverse
    can be composed and conjugated

    translation rotation scaling inversion
    all represented as 4-vectors of complex number

    composition of transformation implemented as
    matrix multipliation of 2x2 complex matrices

    inverse of a transformation as inverse of a 2x2 matrix
    conjugation by a conjugataing map as composition
    of three matrices

*** image of a generalized circle
    image of a circle from
    Grandma's recipe and project 3.7 in Indra's Pearls

    my idea:
    image of a line
    line represented by two points
    look at image of the two points and of their midpoint
    they are either collieanr,
    in which case the image of the line is a line
    or they form a triangle,
    in which case the image of the line is a circle,
    the circumcircle of the triangle

    so what is the circumcircle of a triangle?
    the circumcenter is the intesection of the perpendicualr bisectors
    the radius is the distance
    from the circumcenter
    to one of the vertices of the triangle
    see illuminated triangle

    todo:
    look at method from geometry of complex numbers
    where a generalized circle is repsesented as a Hermitian matrix

*** drawing to canvas
    draw.cljs
    drawing-loop channel
    graphics data

*** handling of events
    mouse click and move events put on events channel
    event handler
    control channel to start and stop

*** technologies used
    core.async channels
    transducers
    data representing geometric entities
    html, canvas, svg, css
    clojurescript, cljsbuild, figwheel, brepl
    om, react
    core.match

** references
   Indra's Pearls
   The vision of felix Klein
   Mumford, Series, Wright

   Visual Complex Analysis
   Tristan Needham

   Geometry of Complex Numbers
   Hans Schwerdttfeger

   Introduction to the
   Geometry of Complex Numbers
   Roland Deaux

   Introduction to Geometry
   Coxeter

** next steps
*** DONE generalized circles
    CLOSED: [2015-06-14 Sun 16:58]
    calculate image of a
    generalized circle
    under any linear fractional transformation

    create representation of
    a generalized circle
    as a Hermitian matrix

*** polar and rectanglar interactive modes
    when mouse is in pre-image canvas
    draw line through mouse and origin
    and circle centered at origin through mouse point
    when in polar mode

    or vertical and horizontal lines through mouse point
    when in rectangular mode

    lines and/or circles in pre-image canvas
    are drawn simultaneously in image canvas
    updated in both canvases as mouse moves

    mouse-mode-state lcoal state
    :polar :reactangular

    need
    events channel: mouse-move, mouse-click
    control channel
    return channel
    screen->user fn

    render list - list of things to be rendered during
    interactive mouse mode
    includes:
    :axis :radial :concentric :horizontal :vertical

    animating-mode
    while in animating mode, temporarily disable mouse mode
    indicate visually, somehow, that an animation is in place

    separate drawing data from animation
    allowing for quick redrawing while in mouse-mode

    button clicks add them to the list
    clear removes them

*** interactive mouse modes
    modes for creating objects
    or for viewing properties

    make lines circles, triangles, quadrangles

    view properties such as
    orthogonal circles with two given centers
    where the third point varies along the circle
    with diameter equal to line between the two centers

    perpendicular bisectors of a line or of three lines of a triangle

    circumcircle through three points
    where two points are fixed and the third varies

    guides exist to make special objects like
    isosceles triangles
    equilateral triangles
    right triangles
    circumcircle of a triangle
    families of orthogonal circles (generalized)
    radial lines, paralell lines, concentric circles
    circles tangent to a point
    circles through two points

*** add grandma's recipes
    add more linear fractional transformations,
    as found in Grandma's recipies

    those that
    - preserve the real line
    - preserve the unit circle, disk
    - preserve the upper half plane
    - pair circles

    - are loxodromic
    - are elliptic
    - are hyperbolic
    - are parabolic

*** allow for input of arbitrary linear fractional transformation
    and switching between a list of transforms, and adding new ones to the list

    allow for input of arbitrary complex number
    in polar and rectangular form
    - as [x y] -> x + iy
    - as [r a] -> r*exp(i*a)
    - as named complex numbers:
      zero one i infity w1
    - as operations on existing complex number
      minus recip conjugate
      and compositions thereof

    allow for input of linear fractional transformations
    by selection from a list or by entering 4 complex numbers

*** show properties of the transformation
    entries a b c d
    determinant
    trace
    inverse
*** allow for conjugation
    with translation, rotation, scaling
*** DONE add unit tests
    CLOSED: [2015-06-18 Thu 10:28]
    unit
*** add more comprehensive unit tests
*** add test.check
    generative tests
    test properties
*** add complex sqrt
    with tests
*** re factor draw
    inta canvas specific stuff
    and mobius stuuf
    add svg impementation
